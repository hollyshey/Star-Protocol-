import numpy as np
import hashlib
import matplotlib.pyplot as plt

class StarNode:
    def __init__(self, seed, freq=1.0):
        """
        ÛŒÚ© Ù†ÙˆØ¯ Ø³ØªØ§Ø±Ù‡â€ŒØ§ÛŒ Ú©Ù‡ Ù…ÙˆØ¬ Ø³ÛŒÙ†ÙˆØ³ÛŒ Ùˆ Ú©Ø³ÛŒÙ†ÙˆØ³ÛŒ Ù‡Ø§Ø±Ù…ÙˆÙ†ÛŒÚ© ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ùˆ Ø¨Ø§ Ù‡Ø± Ù¾Ø§Ù„Ø³ ÙØ±Ú©Ø§Ù†Ø³ Ø±Ø§ ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.
        
        :param seed: Ø±Ø´ØªÙ‡ ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù‡Ø´ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯
        :param freq: ÙØ±Ú©Ø§Ù†Ø³ Ù¾Ø§ÛŒÙ‡ Ù…ÙˆØ¬
        """
        self.seed = seed
        self.freq = freq
        self.time = np.linspace(0, 1, 1024)
        self.internal_wave = self._generate_wave()
        self.clock_state = self._hash_clock()

    def _generate_wave(self):
        # ØªÙˆÙ„ÛŒØ¯ Ù…ÙˆØ¬ ØªØ±Ú©ÛŒØ¨ÛŒ Ø³ÛŒÙ†ÙˆØ³ Ùˆ Ú©Ø³ÛŒÙ†ÙˆØ³ Ù‡Ø§Ø±Ù…ÙˆÙ†ÛŒÚ©
        wave = np.sin(2 * np.pi * self.freq * self.time)
        mod = np.cos(2 * np.pi * self.freq * 1.618 * self.time)
        return wave + mod

    def _hash_clock(self):
        # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‡Ø´ SHA-256 Ø§Ø² Ù…ÙˆØ¬ Ø¯Ø§Ø®Ù„ÛŒ Ùˆ seed
        data = (str(self.internal_wave) + self.seed).encode()
        return hashlib.sha256(data).hexdigest()

    def pulse(self):
        # Ø§ÙØ²Ø§ÛŒØ´ ÙØ±Ú©Ø§Ù†Ø³ Ø¨Ø§ Ø¶Ø±ÛŒØ¨ ØªÙˆÙ† Ù…ÙˆØ³ÛŒÙ‚ÛŒ (ÛŒÚ© Ù†ÛŒÙ…â€ŒÙ¾Ø±Ø¯Ù‡ Ø¨Ø§Ù„Ø§)
        self.freq *= 1.059
        self.internal_wave = self._generate_wave()
        self.clock_state = self._hash_clock()
        return self.clock_state

    def plot_wave(self):
        # Ø±Ø³Ù… Ù…ÙˆØ¬ Ø¯Ø§Ø®Ù„ÛŒ ÙØ¹Ù„ÛŒ
        plt.plot(self.time, self.internal_wave)
        plt.title(f"StarNode Wave at freq = {self.freq:.3f} Hz")
        plt.xlabel("Time")
        plt.ylabel("Amplitude")
        plt.show()

# Ù†Ù…ÙˆÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ùˆ ØªØ³Øª
star = StarNode(seed="âˆ")
for i in range(5):
    print(f"[PULSE {i}] ğŸ”  StarHash: {star.pulse()}")
    star.plot_wave()
